# F18: Design & Engineering of Intelligent Information Systems

## Project 0

* Project 0 Module - https://theproject.zone/f18-11791/pi0

## Development References

* TPZ TA Manual - https://github.com/CloudComputingCourse/TA-Manual

### Submitter

1. In `submitter.sh` implement the `grade` function to include any code that should be run on the student's instance (or wherever the submitter is being run from)
   1. Any files written in the same directory as the submitter (or any child directory) will be included in the submission tar.gz file 

```bash
export TPZ_USERNAME=
export TPZ_PASSWORD=

./submitter.sh
```

[11-791 Submitter HOWTO / Tutorial](https://github.com/riebling/acai/blob/master/submitter.HOWTO.md)

### Grader

#### Important Files
* [Grader.java](grader/src/main/java/edu/cmu/scs/cs/_11791/Grader.java)
  * This is the main class of the resulting jar built by `mvn package`. When to run `mvn package`?
  * It will make use of the `JsonGradeStrategy` class provided by [grader-utils](https://github.com/CloudComputingCourse/grader-utils/wiki/Library-Usage) to evaluate the output generated by the submitter. When? What initiates this action?

* [reference.yaml](grader/src/main/resources/reference.yaml)
  * For the `JsonGradeStrategy` a reference answer will be provided to the grader.
  * In this example, we will read the `output.json` included in the student's submission. The [submitter.sh](submitter/submitter.sh) in this example project will create a submission that includes [output.json](submitter/output.json), which will result in a full score during grading.
  * [reference.yaml](grader/src/main/resources/reference.yaml) has three question (`q1` - `q3`) each worth 5 points. The id `q1` - `q3` corresponds to the column name in the [hello-world](https://theproject.zone/f18-11791/pi0/tasks/hello-world) TPZ task.

#### Build and Deploy
* Before building the package you will need to install the [grader-utils](https://github.com/CloudComputingCourse/grader-utils/wiki/Library-Usage) and [upload-grader-maven-plugin](https://github.com/CloudComputingCourse/CloudComputingUtils/wiki/Plugin-Usage) packages.
* How? What steps to follow to install such things, where do they end up? read on...
* Before that happens, you will need to install Maven and Java.
* Steps to install packages (or are they plugins, or are they projects, or archives, or libraries?)
  - Follow the link to the package page
  - Follow another link to a page with download links
  - Download `grader-utils-1.3.3-RELEASE.jar`, `grader-utils-1.3.3-RELEASE-sources.jar`, `grader-utils-1.3.3-RELEASE-javadoc.jar`, and `upload-grader-maven-plugin-0.0.6-RELEASE.jar` after navigating to them from the linked pages above. You will probably only be able to download them by first authenticating to the linked GitHub repositories in a browser.
  - Because of this, probably copy the four downloaded jar files to your working directory
  - Perform the the `mvn install` commands, as hinted in the linked pages, e.g:
  ```
  mvn install:install-file    -Dfile=grader-utils-"$version"-RELEASE.jar    -DgroupId=edu.cmu.scs.cc.grader    -DartifactId=grader-utils    -Dversion="$version"-RELEASE    -Dpackaging=jar
  mvn install:install-file    -Dfile=grader-utils-"$version"-RELEASE-sources.jar    -DgroupId=edu.cmu.scs.cc.grader    -DartifactId=grader-utils    -Dversion="$version"-RELEASE    -Dpackaging=jar    -Dclassifier=sources
  mvn install:install-file    -Dfile=grader-utils-"$version"-RELEASE-javadoc.jar    -DgroupId=edu.cmu.scs.cc.grader    -DartifactId=grader-utils    -Dversion="$version"-RELEASE    -Dpackaging=jar    -Dclassifier=javadoc
  mvn install:install-file       -Dfile=upload-grader-maven-plugin-0.0.6-RELEASE.jar       -DgroupId=edu.cmu.cs.cloud.plugins       -DartifactId=upload-grader-maven-plugin       -Dversion=0.0.6-RELEASE       -Dpackaging=jar
  ```

```bash
$ cd grader

$ mvn clean package
```
Before deleting the 'example' ~/.m2/settings.xml, it produced:
```[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building project0-grader 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
Downloading: http://repo1.theproject.zone/artifactory/libs-release/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom
Downloading: http://repo1.theproject.zone/artifactory/libs-release/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 0.538 s
[INFO] Finished at: 2018-10-22T15:38:01-04:00
[INFO] Final Memory: 8M/240M
[INFO] ------------------------------------------------------------------------
[ERROR] Plugin org.apache.maven.plugins:maven-clean-plugin:2.5 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.maven.plugins:maven-clean-plugin:jar:2.5: Could not transfer artifact org.apache.maven.plugins:maven-clean-plugin:pom:2.5 from/to central (http://repo1.theproject.zone/artifactory/libs-release): repo1.theproject.zone: No address associated with hostname -> [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/PluginResolutionException
```
Instead, if it works, will start with:
```
[INFO] Building project0-grader 1.0-SNAPSHOT
```
and after pages and pages of downloads, end with:
```
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 10.597 s
[INFO] Finished at: 2018-10-22T15:57:20-04:00
[INFO] Final Memory: 26M/381M
[INFO] ------------------------------------------------------------------------
```
then ...
```
$ mvn upload-grader:upload \
    -Dupload.andrewId=<ANDREW_ID> \
    -Dupload.password=<TPZ_SUBMISSION_PASSWORD> \
    -Dupload.filename=target/java_grader.jar
```
resulted in:
```
er1k@islpc22:~/ACAI/Project0/grader$ mvn upload-grader:upload -e -Dupload.andrewId=er1k@cs.cmu.edu -Dupload.password=H6CmXQOGRc34zRY\
yKzIa9y -Dupload.filename=target/java_grader.jar
[INFO] Error stacktraces are turned on.
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building project0-grader 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- upload-grader-maven-plugin:0.0.6-RELEASE:upload (default-cli) @ project0-grader ---
[INFO] Configuration:   UploadGraderMojo{project=MavenProject: edu.cmu.scs.cs._11791:project0-grader:1.0-SNAPSHOT @ /usr1/er1k/ACAI/\
Project0/grader/pom.xml, taskId=hello-world, semester=f18, courseId=11791, andrewId=er1k@cs.cmu.edu, password=H6CmXQOGRc34zRYyKzIa9y\
, filename=/usr1/er1k/ACAI/Project0/grader/target/java_grader.jar}
[INFO] File to upload:  /usr1/er1k/ACAI/Project0/grader/target/java_grader.jar
edu.cmu.cs.cloud.ags.producer.v2.client.ApiException: 
        at edu.cmu.cs.cloud.ags.producer.v2.client.ApiClient.handleResponse(ApiClient.java:925)
        at edu.cmu.cs.cloud.ags.producer.v2.client.ApiClient.execute(ApiClient.java:841)
        at edu.cmu.cs.cloud.ags.producer.v2.client.api.UploadGraderApi.uploadGraderWithHttpInfo(UploadGraderApi.java:206)
        at edu.cmu.cs.cloud.ags.producer.v2.client.api.UploadGraderApi.uploadGrader(UploadGraderApi.java:186)
        at edu.cmu.cs.cloud.plugins.upload.UploadGraderMojo.execute(UploadGraderMojo.java:50)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:207)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
        at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:307)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:193)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:106)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:863)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:288)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:199)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2.299 s
[INFO] Finished at: 2018-10-22T16:34:01-04:00
[INFO] Final Memory: 9M/186M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal edu.cmu.cs.cloud.plugins:upload-grader-maven-plugin:0.0.6-RELEASE:upload (default-cli) on project pro\
ject0-grader: HTTP related error. HTTP related error.
[ERROR] Error during uploading grader to AGS. Check required parameters.
[ERROR] -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal edu.cmu.cs.cloud.plugins:upload-grader-maven-plugin:0\
.0.6-RELEASE:upload (default-cli) on project project0-grader: HTTP related error.
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:212)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
        at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:307)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:193)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:106)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:863)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:288)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:199)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:498)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
Caused by: org.apache.maven.plugin.MojoExecutionException: HTTP related error.
        at edu.cmu.cs.cloud.plugins.upload.UploadGraderMojo.execute(UploadGraderMojo.java:60)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:207)
        ... 20 more
[ERROR]
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException

```
